<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>一些Yara规则 | Wei's Blog</title><meta name="description" content="一些Yara规则，有些是自己写的，有些是搜集的，能用就行"><meta name="keywords" content="工具"><meta name="author" content="Yenn_"><meta name="copyright" content="Yenn_"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="一些Yara规则"><meta name="twitter:description" content="一些Yara规则，有些是自己写的，有些是搜集的，能用就行"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master/20201201113139.png"><meta property="og:type" content="article"><meta property="og:title" content="一些Yara规则"><meta property="og:url" content="https://0xdf1001f.github.io/2020/12/01/Yara%E8%A7%84%E5%88%99/"><meta property="og:site_name" content="Wei's Blog"><meta property="og:description" content="一些Yara规则，有些是自己写的，有些是搜集的，能用就行"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master/20201201113139.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = '2'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://0xdf1001f.github.io/2020/12/01/Yara%E8%A7%84%E5%88%99/"><link rel="prev" title="Png Dropper" href="https://0xdf1001f.github.io/2020/12/03/Png-Dropper/"><link rel="next" title="在X64DBG中调试DLL的导出函数" href="https://0xdf1001f.github.io/2020/11/24/%E5%9C%A8X64DBG%E4%B8%AD%E8%B0%83%E8%AF%95DLL%E7%9A%84%E5%AF%BC%E5%87%BA%E5%87%BD%E6%95%B0/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: {"text":"富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善","fontSize":"15px"},
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Wei's Blog</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">30</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">15</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">6</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Yara"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">Yara</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#通过数字签名使用Yara-Hunt-文件"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">通过数字签名使用Yara Hunt 文件</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Turla-Carbon-Orchestrator-V3-81"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">Turla - Carbon Orchestrator V3.81</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Turla-Png-Dropper"><span class="toc_mobile_items-number">1.3.</span> <span class="toc_mobile_items-text">Turla - Png Dropper</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#apt-carbon-paper-turla"><span class="toc_mobile_items-number">1.4.</span> <span class="toc_mobile_items-text">apt_carbon_paper_turla</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#SideWinder"><span class="toc_mobile_items-number">1.5.</span> <span class="toc_mobile_items-text">SideWinder</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Bitter"><span class="toc_mobile_items-number">1.6.</span> <span class="toc_mobile_items-text">Bitter</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#PatchWork"><span class="toc_mobile_items-number">1.7.</span> <span class="toc_mobile_items-text">PatchWork</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Donot"><span class="toc_mobile_items-number">1.8.</span> <span class="toc_mobile_items-text">Donot</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Yara"><span class="toc-number">1.</span> <span class="toc-text">Yara</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#通过数字签名使用Yara-Hunt-文件"><span class="toc-number">1.1.</span> <span class="toc-text">通过数字签名使用Yara Hunt 文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Turla-Carbon-Orchestrator-V3-81"><span class="toc-number">1.2.</span> <span class="toc-text">Turla - Carbon Orchestrator V3.81</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Turla-Png-Dropper"><span class="toc-number">1.3.</span> <span class="toc-text">Turla - Png Dropper</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#apt-carbon-paper-turla"><span class="toc-number">1.4.</span> <span class="toc-text">apt_carbon_paper_turla</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SideWinder"><span class="toc-number">1.5.</span> <span class="toc-text">SideWinder</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bitter"><span class="toc-number">1.6.</span> <span class="toc-text">Bitter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PatchWork"><span class="toc-number">1.7.</span> <span class="toc-text">PatchWork</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Donot"><span class="toc-number">1.8.</span> <span class="toc-text">Donot</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master/20201201113139.png)"><div id="post-info"><div id="post-title"><div class="posttitle">一些Yara规则</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-12-01<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2021-02-23</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Windows/">Windows</a><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Windows/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">4.6k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>阅读时长: 28 分钟</span><div class="post-meta-pv-cv"><span class="post-meta__separator">|</span><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><p>用来存放一些恶意样本的Yara规则</p>
<h1 id="Yara"><a href="#Yara" class="headerlink" title="Yara"></a>Yara</h1><h2 id="通过数字签名使用Yara-Hunt-文件"><a href="#通过数字签名使用Yara-Hunt-文件" class="headerlink" title="通过数字签名使用Yara Hunt 文件"></a>通过数字签名使用Yara Hunt 文件</h2><p>需要导入”pe”模块</p>
<p>在证书详情中找到证书的序列号，同时也可以记录下来颁发者</p>
<p><a href="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master//20210204144140.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master//20210204144140.png" class="lazyload"></a></p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">strings:</span><br><span class="line">    	$mz &#x3D; &#123;4d 5a&#125;</span><br><span class="line">    condition:</span><br><span class="line">    	($mz at 0) and (</span><br><span class="line">         for any i in (0 .. pe.number_of_signatures) : (</span><br><span class="line">		 pe.signatures[i].issuer contains &quot;yoyojitox&quot; and   &#x2F;&#x2F;颁发者</span><br><span class="line">         pe.signatures[i].serial &#x3D;&#x3D; &quot;06:fc:34:d3:43:cf:6a:8c:41:e3:aa:c2:85:d6:e4:87&quot;&#x2F;&#x2F;序列号,需要全小写</span><br><span class="line">      ))</span><br></pre></td></tr></table></figure></div>



<h2 id="Turla-Carbon-Orchestrator-V3-81"><a href="#Turla-Carbon-Orchestrator-V3-81" class="headerlink" title="Turla - Carbon Orchestrator V3.81"></a>Turla - Carbon Orchestrator V3.81</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line">import &quot;hash&quot;</span><br><span class="line"></span><br><span class="line">private global rule MZOnly &#123;</span><br><span class="line">    strings:</span><br><span class="line">        $mz &#x3D; &quot;MZ&quot;</span><br><span class="line">    condition:</span><br><span class="line">        $mz at 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private global rule FileSize &#123;</span><br><span class="line">    condition:</span><br><span class="line">        filesize &lt; 1MB</span><br><span class="line">&#125;</span><br><span class="line">rule CarbonOrchestrator_v3_81_ &#123;</span><br><span class="line">	meta:</span><br><span class="line">		Author &#x3D; &quot;Intezer Analyze&quot;</span><br><span class="line">		Reference &#x3D; &quot;https:&#x2F;&#x2F;apt-ecosystem.com&quot;</span><br><span class="line"></span><br><span class="line">	strings:</span><br><span class="line">		$block_0 &#x3D; &#123; E8 ?? ?? ?? ?? 99 B9 ?? ?? ?? ?? F7 ?? 8B ?? 48 ?? ?? ?? ?? 8B ?? ?? 2B ?? 8B ?? 89 ?? ?? ?? EB &#125;</span><br><span class="line">		$block_1 &#x3D; &#123; 8B ?? ?? ?? ?? ?? ?? 8B ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 8B ?? E8 ?? ?? ?? ?? 0F B6 ?? 85 ?? 74 &#125;</span><br><span class="line">		$block_2 &#x3D; &#123; C7 ?? ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? 0F B6 ?? 88 ?? ?? ?? 0F B6 ?? ?? ?? 3D ?? ?? ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_3 &#x3D; &#123; 4C ?? ?? ?? ?? 88 ?? ?? ?? 48 ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? 0F B6 ?? ?? ?? ?? ?? ?? 85 ?? 74 &#125;</span><br><span class="line">		$block_4 &#x3D; &#123; 5? 68 ?? ?? ?? ?? 6A ?? 5? 5? 68 ?? ?? ?? ?? FF 3? ?? ?? ?? ?? FF 1? ?? ?? ?? ?? 83 ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_5 &#x3D; &#123; 5? 68 ?? ?? ?? ?? 6A ?? 5? 5? 68 ?? ?? ?? ?? FF 7? ?? FF 1? ?? ?? ?? ?? 89 ?? ?? 83 ?? ?? 0F 84 &#125;</span><br><span class="line">		$block_6 &#x3D; &#123; 66 ?? ?? ?? 6A ?? 8D ?? ?? 5? 5? 5? FF 7? ?? E8 ?? ?? ?? ?? 83 ?? ?? 8B ?? 89 ?? ?? 85 ?? 0F 85 &#125;</span><br><span class="line">		$block_7 &#x3D; &#123; 89 ?? ?? 6A ?? 8D ?? ?? ?? ?? ?? 5? 5? FF 7? ?? 5? E8 ?? ?? ?? ?? 83 ?? ?? 89 ?? ?? 3B ?? 0F 85 &#125;</span><br><span class="line">		$block_8 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? FF 1? ?? ?? ?? ?? 48 ?? ?? ?? ?? 0F BE ?? ?? 83 ?? ?? 75 &#125;</span><br><span class="line">		$block_9 &#x3D; &#123; 0F B7 ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? FF 9? ?? ?? ?? ?? 48 ?? ?? ?? ?? 66 ?? ?? ?? EB &#125;</span><br><span class="line">		$block_10 &#x3D; &#123; 8D ?? ?? ?? 5? 8D ?? ?? ?? 5? 8D ?? ?? ?? 5? FF 3? ?? ?? ?? ?? FF 1? ?? ?? ?? ?? 84 ?? 0F 84 &#125;</span><br><span class="line">		$block_11 &#x3D; &#123; FF 7? ?? ?? 8B ?? ?? ?? FF 7? ?? ?? E8 ?? ?? ?? ?? 33 ?? 5? 5? 89 ?? ?? ?? 39 ?? ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_12 &#x3D; &#123; 5? FF 1? ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? ?? 5? 89 ?? ?? ?? FF D? 5? 5? 89 ?? ?? ?? 3B ?? 0F 84 &#125;</span><br><span class="line">		$block_13 &#x3D; &#123; FF 7? ?? FF 1? ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? ?? FF 7? ?? FF 1? ?? ?? ?? ?? 5? 5? 85 ?? 0F 85 &#125;</span><br><span class="line">		$block_14 &#x3D; &#123; 0F BE ?? ?? ?? BA ?? ?? ?? ?? 8B ?? E8 ?? ?? ?? ?? 88 ?? ?? ?? 0F B6 ?? ?? ?? 83 ?? ?? 7C &#125;</span><br><span class="line">		$block_15 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 33 ?? 48 ?? ?? ?? ?? E8 ?? ?? ?? ?? 0F B6 ?? 85 ?? 75 &#125;</span><br><span class="line">		$block_16 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? ?? 0F B7 ?? ?? 3D ?? ?? ?? ?? 75 &#125;</span><br><span class="line">		$block_17 &#x3D; &#123; 8B ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? E8 ?? ?? ?? ?? 48 ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? 0F 84 &#125;</span><br><span class="line">		$block_18 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 0F B7 ?? 33 ?? B9 ?? ?? ?? ?? 48 ?? ?? 48 ?? ?? ?? ?? ?? ?? ?? EB &#125;</span><br><span class="line">		$block_19 &#x3D; &#123; 4C ?? ?? ?? ?? 41 ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? 48 ?? ?? ?? ?? E8 ?? ?? ?? ?? 85 ?? 0F 84 &#125;</span><br><span class="line">		$block_20 &#x3D; &#123; FF 1? ?? ?? ?? ?? FF 7? ?? 8B ?? 5? 68 ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 ?? ?? 83 ?? ?? 0F 84 &#125;</span><br><span class="line">		$block_21 &#x3D; &#123; 8B ?? ?? 89 ?? ?? 8D ?? ?? 5? FF 7? ?? 8D ?? ?? E8 ?? ?? ?? ?? 5? 5? 89 ?? ?? 85 ?? 0F 85 &#125;</span><br><span class="line">		$block_22 &#x3D; &#123; 8B ?? 99 F7 ?? 83 ?? ?? ?? 8A ?? 83 ?? ?? ?? 33 ?? 4? 89 ?? ?? 88 ?? ?? 89 ?? ?? 85 ?? 7E &#125;</span><br><span class="line">		$block_23 &#x3D; &#123; 8B ?? ?? 6A ?? 8D ?? ?? ?? 5? 5? 5? FF 7? ?? ?? E8 ?? ?? ?? ?? 8B ?? 83 ?? ?? 3B ?? 0F 85 &#125;</span><br><span class="line">		$block_24 &#x3D; &#123; 8B ?? ?? ?? 44 ?? ?? 48 ?? ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? E8 ?? ?? ?? ?? 85 ?? 0F 85 &#125;</span><br><span class="line">		$block_25 &#x3D; &#123; 48 ?? ?? ?? ?? FF 1? ?? ?? ?? ?? 88 ?? ?? ?? ?? ?? ?? 0F B6 ?? ?? ?? ?? ?? ?? 85 ?? 74 &#125;</span><br><span class="line">		$block_26 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 0F B6 ?? ?? 88 ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? 75 &#125;</span><br><span class="line">		$block_27 &#x3D; &#123; 48 ?? ?? ?? ?? 48 ?? ?? ?? ?? 0F B6 ?? ?? 88 ?? ?? ?? 8B ?? ?? ?? FF C? 89 ?? ?? ?? C7 &#125;</span><br><span class="line">		$block_28 &#x3D; &#123; 8B ?? ?? ?? ?? ?? ?? 8B ?? ?? ?? E8 ?? ?? ?? ?? 8B ?? E8 ?? ?? ?? ?? 0F B6 ?? 85 ?? 74 &#125;</span><br><span class="line">		$block_29 &#x3D; &#123; 41 ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? E8 ?? ?? ?? ?? 0F B6 ?? 85 ?? 75 &#125;</span><br><span class="line">		$block_30 &#x3D; &#123; 0F B6 ?? 23 ?? ?? 8B ?? ?? D3 ?? 8B ?? ?? D2 ?? 0A ?? FF 4? ?? 83 ?? ?? ?? 8B ?? ?? 7C &#125;</span><br><span class="line">		$block_31 &#x3D; &#123; 6A ?? 8D ?? ?? ?? 5? 5? FF 7? ?? ?? FF 7? ?? E8 ?? ?? ?? ?? 8B ?? 83 ?? ?? 85 ?? 0F 85 &#125;</span><br><span class="line">		$block_32 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 0F B7 ?? 33 ?? B9 ?? ?? ?? ?? 48 ?? ?? 48 ?? ?? ?? ?? ?? 73 &#125;</span><br><span class="line">		$block_33 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? 0F BE ?? ?? ?? 83 ?? ?? 74 &#125;</span><br><span class="line">		$block_34 &#x3D; &#123; 48 ?? ?? ?? ?? 8B ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 89 ?? ?? ?? 83 ?? ?? ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_35 &#x3D; &#123; 48 ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? 48 ?? ?? E8 ?? ?? ?? ?? 0F B6 ?? 83 ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_36 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? ?? FF 1? ?? ?? ?? ?? 83 ?? ?? 0F 84 &#125;</span><br><span class="line">		$block_37 &#x3D; &#123; 0F BF ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? ?? 89 ?? C7 ?? ?? ?? ?? ?? ?? ?? E9 &#125;</span><br><span class="line">		$block_38 &#x3D; &#123; 48 ?? ?? ?? ?? 48 ?? ?? ?? ?? FF 1? ?? ?? ?? ?? 89 ?? ?? ?? 83 ?? ?? ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_39 &#x3D; &#123; 0F BF ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? ?? 89 ?? C7 ?? ?? ?? ?? ?? ?? ?? EB &#125;</span><br><span class="line">		$block_40 &#x3D; &#123; 8B ?? ?? ?? 8B ?? ?? ?? 03 ?? 8B ?? 89 ?? ?? ?? 8B ?? ?? ?? 39 ?? ?? ?? 0F 82 &#125;</span><br><span class="line">		$block_41 &#x3D; &#123; 48 ?? ?? ?? ?? 48 ?? ?? ?? ?? E8 ?? ?? ?? ?? 89 ?? ?? ?? 83 ?? ?? ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_42 &#x3D; &#123; FF 1? ?? ?? ?? ?? 89 ?? ?? ?? ?? ?? ?? 81 B? ?? ?? ?? ?? ?? ?? ?? ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_43 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? ?? FF 1? ?? ?? ?? ?? 48 ?? ?? 0F 84 &#125;</span><br><span class="line">		$block_44 &#x3D; &#123; 33 ?? 48 ?? ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 89 ?? ?? ?? 83 ?? ?? ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_45 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? ?? FF 1? ?? ?? ?? ?? 48 ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_46 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? FF 1? ?? ?? ?? ?? 0F B6 ?? ?? ?? ?? ?? ?? 83 ?? ?? 75 &#125;</span><br><span class="line">		$block_47 &#x3D; &#123; 0F BE ?? ?? ?? 8B ?? 48 ?? ?? ?? ?? ?? ?? ?? FF 1? ?? ?? ?? ?? 48 ?? ?? 74 &#125;</span><br><span class="line">		$block_48 &#x3D; &#123; B2 ?? 48 ?? ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 83 ?? ?? ?? ?? ?? ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_49 &#x3D; &#123; 48 ?? ?? ?? ?? 48 ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? 8B ?? ?? ?? 39 ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_50 &#x3D; &#123; 48 ?? ?? ?? ?? C7 ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? 0F B7 ?? ?? 85 ?? 74 &#125;</span><br><span class="line">		$block_51 &#x3D; &#123; 0F B7 ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? FF 9? ?? ?? ?? ?? 66 ?? ?? ?? ?? EB &#125;</span><br><span class="line">		$block_52 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 85 ?? 0F 85 &#125;</span><br><span class="line">		$block_53 &#x3D; &#123; 48 ?? ?? ?? ?? 48 ?? ?? ?? ?? 8B ?? ?? 8B ?? ?? 2B ?? 3B ?? ?? ?? 0F 87 &#125;</span><br><span class="line">		$block_54 &#x3D; &#123; 0F B6 ?? ?? ?? B9 ?? ?? ?? ?? 2B ?? 8B ?? 0F B6 ?? ?? ?? 03 ?? 8B ?? 88 &#125;</span><br><span class="line">		$block_55 &#x3D; &#123; 8B ?? ?? ?? ?? ?? ?? FF C? 48 ?? 48 ?? ?? ?? ?? 0F BE ?? ?? 85 ?? 75 &#125;</span><br><span class="line">		$block_56 &#x3D; &#123; 0F BE ?? ?? ?? 8B ?? 48 ?? ?? ?? ?? FF 1? ?? ?? ?? ?? 48 ?? ?? 74 &#125;</span><br><span class="line">		$block_57 &#x3D; &#123; 48 ?? ?? ?? ?? 8B ?? ?? 99 83 ?? ?? 03 ?? C1 ?? ?? 39 ?? ?? ?? 7E &#125;</span><br><span class="line">		$block_58 &#x3D; &#123; 0F B7 ?? ?? ?? 48 ?? ?? ?? 48 ?? ?? ?? 8B ?? ?? ?? 39 ?? ?? ?? 77 &#125;</span><br><span class="line">		$block_59 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? ?? 0F 84 &#125;</span><br><span class="line">		$block_60 &#x3D; &#123; 8B ?? ?? ?? 8B ?? ?? ?? ?? ?? ?? 2B ?? 8B ?? 3D ?? ?? ?? ?? 0F 8C &#125;</span><br><span class="line">		$block_61 &#x3D; &#123; B2 ?? 48 ?? ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 0F B6 ?? 85 ?? 75 &#125;</span><br><span class="line">		$block_62 &#x3D; &#123; 0F B6 ?? ?? ?? ?? ?? ?? 88 ?? ?? ?? 0F B6 ?? ?? ?? 85 ?? 0F 84 &#125;</span><br><span class="line">		$block_63 &#x3D; &#123; 48 ?? ?? ?? ?? 0F B6 ?? 88 ?? ?? ?? 0F B6 ?? ?? ?? 83 ?? ?? 75 &#125;</span><br><span class="line">		$block_64 &#x3D; &#123; 8B ?? ?? ?? FF C? 89 ?? ?? ?? 0F B7 ?? ?? ?? 39 ?? ?? ?? 0F 83 &#125;</span><br><span class="line">		$block_65 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 8B ?? ?? 39 ?? ?? ?? ?? ?? ?? 0F 83 &#125;</span><br><span class="line">		$block_66 &#x3D; &#123; 0F B7 ?? ?? ?? ?? ?? ?? 0F B7 ?? ?? ?? ?? ?? ?? 3B ?? 0F 85 &#125;</span><br><span class="line">		$block_67 &#x3D; &#123; 48 ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? 0F 84 &#125;</span><br><span class="line">		$block_68 &#x3D; &#123; 8B ?? ?? ?? FF C? 48 ?? 48 ?? ?? ?? ?? 0F BE ?? ?? 85 ?? 75 &#125;</span><br><span class="line">		$block_69 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 0F B6 ?? 83 ?? ?? 75 &#125;</span><br><span class="line">		$block_70 &#x3D; &#123; 0F B7 ?? ?? ?? ?? ?? ?? 0F B7 ?? ?? ?? ?? ?? ?? 3B ?? 7D &#125;</span><br><span class="line">		$block_71 &#x3D; &#123; 0F B7 ?? ?? ?? ?? ?? ?? 0F B7 ?? ?? ?? ?? ?? ?? 3B ?? 75 &#125;</span><br><span class="line">		$block_72 &#x3D; &#123; 0F B7 ?? ?? ?? ?? ?? ?? 0F B7 ?? ?? ?? ?? ?? ?? 3B ?? 7F &#125;</span><br><span class="line">		$block_73 &#x3D; &#123; 8B ?? ?? ?? 8B ?? ?? ?? ?? ?? ?? 2B ?? 8B ?? 85 ?? 0F 85 &#125;</span><br><span class="line">		$block_74 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? 48 ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_75 &#x3D; &#123; 8B ?? ?? ?? 8B ?? ?? ?? ?? ?? ?? 2B ?? 8B ?? 85 ?? 0F 8E &#125;</span><br><span class="line">		$block_76 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_77 &#x3D; &#123; 48 ?? ?? ?? ?? 48 ?? ?? ?? ?? 8B ?? ?? 39 ?? ?? 0F 83 &#125;</span><br><span class="line">		$block_78 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 0F B7 ?? ?? 3D ?? ?? ?? ?? 75 &#125;</span><br><span class="line">		$block_79 &#x3D; &#123; B2 ?? 48 ?? ?? ?? ?? E8 ?? ?? ?? ?? 0F B6 ?? 85 ?? 75 &#125;</span><br><span class="line">		$block_80 &#x3D; &#123; 8B ?? ?? ?? 8B ?? ?? ?? FF C? 89 ?? ?? ?? 85 ?? 0F 84 &#125;</span><br><span class="line">		$block_81 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 48 ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_82 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 0F B7 ?? ?? 3D ?? ?? ?? ?? 74 &#125;</span><br><span class="line">		$block_83 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? E8 ?? ?? ?? ?? 48 ?? ?? 0F 86 &#125;</span><br><span class="line">		$block_84 &#x3D; &#123; 33 ?? 8B ?? ?? ?? F7 ?? ?? ?? FF C? 0F AF ?? ?? ?? 89 &#125;</span><br><span class="line">		$block_85 &#x3D; &#123; 8B ?? ?? ?? 48 ?? ?? ?? ?? 0F BE ?? ?? 85 ?? 0F 85 &#125;</span><br><span class="line">		$block_86 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 83 ?? ?? ?? ?? ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_87 &#x3D; &#123; 0F B7 ?? ?? ?? ?? ?? ?? 25 ?? ?? ?? ?? 85 ?? 0F 84 &#125;</span><br><span class="line">		$block_88 &#x3D; &#123; 0F B7 ?? ?? ?? 48 ?? ?? ?? ?? 0F B7 ?? ?? 3B ?? 7D &#125;</span><br><span class="line">		$block_89 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 0F B7 ?? 39 ?? ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_90 &#x3D; &#123; 8B ?? ?? ?? ?? ?? ?? 48 ?? ?? ?? ?? ?? ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_91 &#x3D; &#123; 48 ?? ?? ?? ?? 48 ?? ?? 83 ?? ?? ?? ?? ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_92 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 0F B7 ?? ?? 83 ?? ?? 75 &#125;</span><br><span class="line">		$block_93 &#x3D; &#123; 8B ?? ?? ?? ?? ?? ?? 0F BE ?? ?? ?? 83 ?? ?? 74 &#125;</span><br><span class="line">		$block_94 &#x3D; &#123; 8B ?? ?? ?? ?? ?? ?? 39 ?? ?? ?? ?? ?? ?? 0F 83 &#125;</span><br><span class="line">		$block_95 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 0F BE ?? ?? 83 ?? ?? 75 &#125;</span><br><span class="line">		$block_96 &#x3D; &#123; 48 ?? ?? ?? ?? 48 ?? ?? ?? ?? 48 ?? ?? ?? 0F 85 &#125;</span><br><span class="line">		$block_97 &#x3D; &#123; B9 ?? ?? ?? ?? E8 ?? ?? ?? ?? 0F B6 ?? 85 ?? 74 &#125;</span><br><span class="line">		$block_98 &#x3D; &#123; 48 ?? ?? ?? ?? ?? ?? ?? 0F BE ?? ?? 83 ?? ?? 74 &#125;</span><br><span class="line">		$block_99 &#x3D; &#123; 8B ?? ?? ?? ?? ?? ?? 39 ?? ?? ?? ?? ?? ?? 0F 8D &#125;</span><br><span class="line"></span><br><span class="line">	condition:</span><br><span class="line">		hash.sha256(0, filesize) &#x3D;&#x3D; &quot;e82d4b6d037568a4602e70f099005572b587c220793afd8f90c13cb7bbde61ed&quot; or</span><br><span class="line">		hash.sha256(0, filesize) &#x3D;&#x3D; &quot;d1ad698567b04ea5ce8197c0316444ad8ee0350b46e0414f53f54c278b393a19&quot; or</span><br><span class="line">		hash.sha256(0, filesize) &#x3D;&#x3D; &quot;7fa4482bfbca550ce296d8e791b1091d60d733ea8042167fd0eb853530584452&quot; or</span><br><span class="line">		24 of them</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="Turla-Png-Dropper"><a href="#Turla-Png-Dropper" class="headerlink" title="Turla - Png Dropper"></a>Turla - Png Dropper</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">import &quot;pe&quot;</span><br><span class="line"></span><br><span class="line">rule turla_png_dropper &#123;</span><br><span class="line">    meta:</span><br><span class="line">        author &#x3D; &quot;Ben Humphrey&quot;</span><br><span class="line">        description &#x3D; &quot;Detects the PNG Dropper used by the Turla group&quot;</span><br><span class="line">        reference &#x3D; &quot;https:&#x2F;&#x2F;www.nccgroup.trust&#x2F;uk&#x2F;about-us&#x2F;newsroom-and-events&#x2F;blogs&#x2F;2018&#x2F;november&#x2F;turla-png-dropper-is-back&#x2F;&quot;</span><br><span class="line">        date &#x3D; &quot;2018&#x2F;11&#x2F;23&quot;</span><br><span class="line">        hash1 &#x3D; &quot;6ed939f59476fd31dc4d99e96136e928fbd88aec0d9c59846092c0e93a3c0e27&quot;</span><br><span class="line">    strings:</span><br><span class="line">        $api0 &#x3D; &quot;GdiplusStartup&quot;</span><br><span class="line">        $api1 &#x3D; &quot;GdipAlloc&quot;</span><br><span class="line">        $api2 &#x3D; &quot;GdipCreateBitmapFromStreamICM&quot;</span><br><span class="line">        $api3 &#x3D; &quot;GdipBitmapLockBits&quot;</span><br><span class="line">        $api4 &#x3D; &quot;GdipGetImageWidth&quot;</span><br><span class="line">        $api5 &#x3D; &quot;GdipGetImageHeight&quot;</span><br><span class="line">        $api6 &#x3D; &quot;GdiplusShutdown&quot;</span><br><span class="line">        $code32 &#x3D; &#123;</span><br><span class="line">            8B 46 3C               &#x2F;&#x2F; mov     eax, [esi+3Ch]</span><br><span class="line">            B9 0B 01 00 00         &#x2F;&#x2F; mov     ecx, 10Bh</span><br><span class="line">            66 39 4C 30 18         &#x2F;&#x2F; cmp     [eax+esi+18h], cx</span><br><span class="line">            8B 44 30 28            &#x2F;&#x2F; mov     eax, [eax+esi+28h]</span><br><span class="line">            6A 00                  &#x2F;&#x2F; push    0</span><br><span class="line">            B9 AF BE AD DE         &#x2F;&#x2F; mov     ecx, 0DEADBEAFh</span><br><span class="line">            51                     &#x2F;&#x2F; push    ecx</span><br><span class="line">            51                     &#x2F;&#x2F; push    ecx</span><br><span class="line">            03 C6                  &#x2F;&#x2F; add     eax, esi</span><br><span class="line">            56                     &#x2F;&#x2F; push    esi</span><br><span class="line">            FF D0                  &#x2F;&#x2F; call eax</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $code64 &#x3D; &#123;</span><br><span class="line">            48 63 43 3C            &#x2F;&#x2F; movsxd rax, dword ptr [rbx+3Ch]</span><br><span class="line">            B9 0B 01 00 00         &#x2F;&#x2F; mov ecx, 10Bh</span><br><span class="line">            BA AF BE AD DE         &#x2F;&#x2F; mov edx, 0DEADBEAFh</span><br><span class="line">            66 39 4C 18 18         &#x2F;&#x2F; cmp [rax+rbx+18h], cx</span><br><span class="line">            8B 44 18 28            &#x2F;&#x2F; mov eax, [rax+rbx+28h]</span><br><span class="line">            45 33 C9               &#x2F;&#x2F; xor r9d, r9d</span><br><span class="line">            44 8B C2               &#x2F;&#x2F; mov r8d, edx</span><br><span class="line">            48 8B CB               &#x2F;&#x2F; mov rcx, rbx</span><br><span class="line">            48 03 C3               &#x2F;&#x2F; add rax, rbx</span><br><span class="line">            FF D0                  &#x2F;&#x2F; call rax</span><br><span class="line">        &#125;</span><br><span class="line">        condition:</span><br><span class="line">        (uint16(0) &#x3D;&#x3D; 0x5A4D and uint16(uint32(0x3c)) &#x3D;&#x3D; 0x4550) and</span><br><span class="line">        all of ($api*) and</span><br><span class="line">        1 of ($code*)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rule turla_png_reg_enum_payload &#123;</span><br><span class="line">    meta:</span><br><span class="line">        author &#x3D; &quot;Ben Humphrey&quot;</span><br><span class="line">        description &#x3D; &quot;Payload that has most recently been dropped by the Turla PNG Dropper&quot;</span><br><span class="line">        reference &#x3D; &quot;https:&#x2F;&#x2F;www.nccgroup.trust&#x2F;uk&#x2F;about-us&#x2F;newsroom-and-events&#x2F;blogs&#x2F;2018&#x2F;november&#x2F;turla-png-dropper-is-back&#x2F;&quot;</span><br><span class="line">        date &#x3D; &quot;2018&#x2F;11&#x2F;23&quot;</span><br><span class="line">        hash1 &#x3D; &quot;fea27eb2e939e930c8617dcf64366d1649988f30555f6ee9cd09fe54e4bc22b3&quot;</span><br><span class="line">    strings:</span><br><span class="line">        $crypt00 &#x3D; &quot;Microsoft Software Key Storage Provider&quot; wide</span><br><span class="line">        $crypt01 &#x3D; &quot;ChainingModeCBC&quot; wide</span><br><span class="line">        &#x2F;* $crypt02 &#x3D; &quot;AES&quot; wide *&#x2F; &#x2F;* disabled due to performance reasons *&#x2F;</span><br><span class="line">    condition:</span><br><span class="line">        (uint16(0) &#x3D;&#x3D; 0x5A4D and uint16(uint32(0x3c)) &#x3D;&#x3D; 0x4550) and</span><br><span class="line">        pe.imports(&quot;advapi32.dll&quot;, &quot;StartServiceCtrlDispatcherA&quot;) and</span><br><span class="line">        pe.imports(&quot;advapi32.dll&quot;, &quot;RegEnumValueA&quot;) and</span><br><span class="line">        pe.imports(&quot;advapi32.dll&quot;, &quot;RegEnumKeyExA&quot;) and</span><br><span class="line">        pe.imports(&quot;ncrypt.dll&quot;, &quot;NCryptOpenStorageProvider&quot;) and</span><br><span class="line">        pe.imports(&quot;ncrypt.dll&quot;, &quot;NCryptEnumKeys&quot;) and</span><br><span class="line">        pe.imports(&quot;ncrypt.dll&quot;, &quot;NCryptOpenKey&quot;) and</span><br><span class="line">        pe.imports(&quot;ncrypt.dll&quot;, &quot;NCryptDecrypt&quot;) and</span><br><span class="line">        pe.imports(&quot;ncrypt.dll&quot;, &quot;BCryptGenerateSymmetricKey&quot;) and</span><br><span class="line">        pe.imports(&quot;ncrypt.dll&quot;, &quot;BCryptGetProperty&quot;) and</span><br><span class="line">        pe.imports(&quot;ncrypt.dll&quot;, &quot;BCryptDecrypt&quot;) and</span><br><span class="line">        pe.imports(&quot;ncrypt.dll&quot;, &quot;BCryptEncrypt&quot;) and</span><br><span class="line">        all of them</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="apt-carbon-paper-turla"><a href="#apt-carbon-paper-turla" class="headerlink" title="apt_carbon_paper_turla"></a>apt_carbon_paper_turla</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; For feedback or questions contact us at: github@eset.com</span><br><span class="line">&#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;eset&#x2F;malware-ioc&#x2F;</span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line">&#x2F;&#x2F; These yara rules are provided to the community under the two-clause BSD</span><br><span class="line">&#x2F;&#x2F; license as follows:</span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line">&#x2F;&#x2F; Copyright (c) 2017, ESET</span><br><span class="line">&#x2F;&#x2F; All rights reserved.</span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line">&#x2F;&#x2F; Redistribution and use in source and binary forms, with or without</span><br><span class="line">&#x2F;&#x2F; modification, are permitted provided that the following conditions are met:</span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line">&#x2F;&#x2F; 1. Redistributions of source code must retain the above copyright notice, this</span><br><span class="line">&#x2F;&#x2F; list of conditions and the following disclaimer.</span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line">&#x2F;&#x2F; 2. Redistributions in binary form must reproduce the above copyright notice,</span><br><span class="line">&#x2F;&#x2F; this list of conditions and the following disclaimer in the documentation</span><br><span class="line">&#x2F;&#x2F; and&#x2F;or other materials provided with the distribution.</span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line">&#x2F;&#x2F; THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span><br><span class="line">&#x2F;&#x2F; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span><br><span class="line">&#x2F;&#x2F; IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span><br><span class="line">&#x2F;&#x2F; DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span><br><span class="line">&#x2F;&#x2F; FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span><br><span class="line">&#x2F;&#x2F; DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span><br><span class="line">&#x2F;&#x2F; SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span><br><span class="line">&#x2F;&#x2F; CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span><br><span class="line">&#x2F;&#x2F; OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span><br><span class="line">&#x2F;&#x2F; OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line">import &quot;pe&quot;</span><br><span class="line"></span><br><span class="line">rule generic_carbon</span><br><span class="line">&#123;</span><br><span class="line">  meta:</span><br><span class="line">    author      &#x3D; &quot;ESET Research&quot;</span><br><span class="line">    date        &#x3D; &quot;2017-03-30&quot;</span><br><span class="line">    description &#x3D; &quot;Turla Carbon malware&quot;</span><br><span class="line">    reference   &#x3D; &quot;https:&#x2F;&#x2F;www.welivesecurity.com&#x2F;2017&#x2F;03&#x2F;30&#x2F;carbon-paper-peering-turlas-second-stage-backdoor&#x2F;&quot;</span><br><span class="line">    source &#x3D; &quot;https:&#x2F;&#x2F;github.com&#x2F;eset&#x2F;malware-ioc&#x2F;&quot;</span><br><span class="line">    contact &#x3D; &quot;github@eset.com&quot;</span><br><span class="line">    license &#x3D; &quot;BSD 2-Clause&quot;</span><br><span class="line"></span><br><span class="line">  strings:</span><br><span class="line">    $s1 &#x3D; &quot;ModStart&quot;</span><br><span class="line">    $t1 &#x3D; &quot;STOP|OK&quot;</span><br><span class="line">    $t2 &#x3D; &quot;STOP|KILL&quot;</span><br><span class="line"></span><br><span class="line">  condition:</span><br><span class="line">    (uint16(0) &#x3D;&#x3D; 0x5a4d) and (1 of ($s*)) and (1 of ($t*))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rule carbon_metadata</span><br><span class="line">&#123;</span><br><span class="line">  meta:</span><br><span class="line">    author      &#x3D; &quot;ESET Research&quot;</span><br><span class="line">    date        &#x3D; &quot;2017-03-30&quot;</span><br><span class="line">    description &#x3D; &quot;Turla Carbon malware&quot;</span><br><span class="line">    reference   &#x3D; &quot;https:&#x2F;&#x2F;www.welivesecurity.com&#x2F;2017&#x2F;03&#x2F;30&#x2F;carbon-paper-peering-turlas-second-stage-backdoor&#x2F;&quot;</span><br><span class="line">    source &#x3D; &quot;https:&#x2F;&#x2F;github.com&#x2F;eset&#x2F;malware-ioc&#x2F;&quot;</span><br><span class="line">    contact &#x3D; &quot;github@eset.com&quot;</span><br><span class="line">    license &#x3D; &quot;BSD 2-Clause&quot;</span><br><span class="line"></span><br><span class="line">   condition:</span><br><span class="line">      (pe.version_info[&quot;InternalName&quot;] contains &quot;SERVICE.EXE&quot; or</span><br><span class="line">       pe.version_info[&quot;InternalName&quot;] contains &quot;MSIMGHLP.DLL&quot; or</span><br><span class="line">       pe.version_info[&quot;InternalName&quot;] contains &quot;MSXIML.DLL&quot;)</span><br><span class="line">       and pe.version_info[&quot;CompanyName&quot;] contains &quot;Microsoft Corporation&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="SideWinder"><a href="#SideWinder" class="headerlink" title="SideWinder"></a>SideWinder</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;2021-01-14 19:27</span><br><span class="line">rule SideWinderRTF &#123;</span><br><span class="line">	meta:</span><br><span class="line">		description &#x3D; &quot;Detects SideWinder RTF Files&quot;</span><br><span class="line">		reference &#x3D; &quot;https:&#x2F;&#x2F;otx.alienvault.com&#x2F;pulse&#x2F;5f21d5b84d529ed134127a66&quot;</span><br><span class="line">		from &#x3D; &quot;https:&#x2F;&#x2F;cdn-cybersecurity.att.com&#x2F;docs&#x2F;global-perspective-of-the-sidewinder-apt.pdf&quot;</span><br><span class="line">	strings:</span><br><span class="line">		$s1 &#x3D;&#123;423130434631333035413937333746454533363035363638374244313942443633314439353545363944463146453045314235373143434143463342373741433630434538314341463630303332354234443131384336363441313543344637454637&#125;</span><br><span class="line">		$s2 &#x3D;&#123;303036313030303130353030303030303030303030307D7B5C726573756C7420207D7D7B5C6F626A6563745C6F626A&#125;</span><br><span class="line">		$s3 &#x3D;&#123;4433433043373132394239423235374642394243414238363836463646394338454139424436453835453333384632353133314337343443344230394141334644304341314446334330384130434637383930364537304531334543353846303933&#125;</span><br><span class="line">	condition:</span><br><span class="line">		uint16(0) &#x3D;&#x3D; 0x5c7b and all of them</span><br><span class="line">&#125;</span><br><span class="line">rule SideWinder_loader_dll</span><br><span class="line">&#123;</span><br><span class="line">	meta:</span><br><span class="line">		author &#x3D; &quot;AT&amp;T Alien Labs&quot;</span><br><span class="line">		description &#x3D; &quot;Detects SideWinder first dll loader&quot;</span><br><span class="line">		hash &#x3D; &quot;113c1c5e176cebe42e452e7ec6ded434c8f620372cef7ae7bfdc6b9469c1b3a4&quot;</span><br><span class="line">		reference &#x3D; &quot;https:&#x2F;&#x2F;otx.alienvault.com&#x2F;pulse&#x2F;5f21d5b84d529ed134127a66&quot;</span><br><span class="line">	strings:</span><br><span class="line">		$code &#x3D; &#123;06 0A 06 8E 69 1F 20 59 8D (0E | 10) 00 00 01 0B 12 00 1F 20 12 01 07 8E 69 28 04 00 00 06 16 0C 2B 16 07 08 8F (0E | 10) 00 00 01 25 47 06 08 1F 20 5D 91 61 D2 52 08 17 58 0C 08 07 8E 69 32 E4 07 28 03 00 00 06 80 01 00 00 04 2A&#125;</span><br><span class="line"> &#x2F;&#x2F;$tmp &#x3D; &#123;2E 00 74 00 6D 00 70 00 20 00 20 00 20 00 20 00 20 00&#125;</span><br><span class="line">		$tmp &#x3D; &quot;.tmp &quot; wide</span><br><span class="line">	condition:</span><br><span class="line">		uint16(0) &#x3D;&#x3D; 0x5A4D and all of them</span><br><span class="line">&#125;</span><br><span class="line">rule SideWinder_implant</span><br><span class="line">&#123;</span><br><span class="line">	meta:</span><br><span class="line">		author &#x3D; &quot;AT&amp;T Alien Labs&quot;</span><br><span class="line">		description &#x3D; &quot;Detects SideWinder final payload&quot;</span><br><span class="line">		hash &#x3D; &quot;c568238dcf1e30d55a398579a4704ddb8196b685&quot;</span><br><span class="line">		reference &#x3D; &quot;https:&#x2F;&#x2F;otx.alienvault.com&#x2F;pulse&#x2F;5f21d5b84d529ed134127a66&quot;</span><br><span class="line">	strings:</span><br><span class="line">		$code &#x3D; &#123;1B 30 05 00 C7 00 00 00 00 00 00 00 02 28 03 00 00 06 7D 12 00 00 04 02 02 FE 06 23 00 00 06 73 5B 00 00 0A 14 20 88 13 00 00 15 73 5C 00 00 0A 7D 13 00 00 04 02 02 FE 06 24 00 00 06 73 5B 00 00 0A 14 20 88 13 00 00 15 73 5C 00 00 0A 7D 15 00 00 04 02 7B 12 00 00 04 6F 0E 00 00 06 2C 1D 02 28 1F 00 00 06 02 7B 12 00 00 04 16 6F 0F 00 00 06 02 7B 12 00 00 04 6F 06 00 00 06 02 7B 12 00 00 04 6F 10 00 00 06 2C 23 02 28 20 00 00 06 02 28 21 00 00 06 02 7B 12 00 00 04 16&#125;</span><br><span class="line">		$strings &#x3D; &#123;2E 00 73 00 69 00 66 00 00 09 2E 00 66 00 6C 00 63 00 00 1B 73 00 65 00 6C 00 65 00 63 00 74 00 65 00 64 00 46 00 69 00 6C 00 65 00 73&#125;</span><br><span class="line">	condition:</span><br><span class="line">		uint16(0) &#x3D;&#x3D; 0x5A4D and all of them</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="Bitter"><a href="#Bitter" class="headerlink" title="Bitter"></a>Bitter</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><span class="line">rule Bitter_Artra_AutoDownloader &#123;</span><br><span class="line"></span><br><span class="line">    meta:</span><br><span class="line">        date &#x3D; &quot;2020-12-22&quot;</span><br><span class="line">    strings:</span><br><span class="line">        $sequence_0 &#x3D; &#123; 8b442410 5f 5e 83c41c c21000 5f 33c0 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 7, score &#x3D; 800</span><br><span class="line">            &#x2F;&#x2F;   8b442410             | mov                 eax, dword ptr [esp + 0x10]</span><br><span class="line">            &#x2F;&#x2F;   5f                   | pop                 edi</span><br><span class="line">            &#x2F;&#x2F;   5e                   | pop                 esi</span><br><span class="line">            &#x2F;&#x2F;   83c41c               | add                 esp, 0x1c</span><br><span class="line">            &#x2F;&#x2F;   c21000               | ret                 0x10</span><br><span class="line">            &#x2F;&#x2F;   5f                   | pop                 edi</span><br><span class="line">            &#x2F;&#x2F;   33c0                 | xor                 eax, eax</span><br><span class="line"></span><br><span class="line">        $sequence_1 &#x3D; &#123; 51 8bc6 57 33c9 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 4, score &#x3D; 700</span><br><span class="line">            &#x2F;&#x2F;   51                   | push                ecx</span><br><span class="line">            &#x2F;&#x2F;   8bc6                 | mov                 eax, esi</span><br><span class="line">            &#x2F;&#x2F;   57                   | push                edi</span><br><span class="line">            &#x2F;&#x2F;   33c9                 | xor                 ecx, ecx</span><br><span class="line"></span><br><span class="line">        $sequence_2 &#x3D; &#123; 8bc6 41 8d7801 8d9b00000000 8a10 40 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 6, score &#x3D; 700</span><br><span class="line">            &#x2F;&#x2F;   8bc6                 | mov                 eax, esi</span><br><span class="line">            &#x2F;&#x2F;   41                   | inc                 ecx</span><br><span class="line">            &#x2F;&#x2F;   8d7801               | lea                 edi, [eax + 1]</span><br><span class="line">            &#x2F;&#x2F;   8d9b00000000         | lea                 ebx, [ebx]</span><br><span class="line">            &#x2F;&#x2F;   8a10                 | mov                 dl, byte ptr [eax]</span><br><span class="line">            &#x2F;&#x2F;   40                   | inc                 eax</span><br><span class="line"></span><br><span class="line">        $sequence_3 &#x3D; &#123; 84d2 75f9 2bc7 3bc8 72e3 8bc6 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 6, score &#x3D; 700</span><br><span class="line">            &#x2F;&#x2F;   84d2                 | test                dl, dl</span><br><span class="line">            &#x2F;&#x2F;   75f9                 | jne                 0xfffffffb</span><br><span class="line">            &#x2F;&#x2F;   2bc7                 | sub                 eax, edi</span><br><span class="line">            &#x2F;&#x2F;   3bc8                 | cmp                 ecx, eax</span><br><span class="line">            &#x2F;&#x2F;   72e3                 | jb                  0xffffffe5</span><br><span class="line">            &#x2F;&#x2F;   8bc6                 | mov                 eax, esi</span><br><span class="line"></span><br><span class="line">        $sequence_4 &#x3D; &#123; 57 33c9 8d7801 8da42400000000 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 4, score &#x3D; 700</span><br><span class="line">            &#x2F;&#x2F;   57                   | push                edi</span><br><span class="line">            &#x2F;&#x2F;   33c9                 | xor                 ecx, ecx</span><br><span class="line">            &#x2F;&#x2F;   8d7801               | lea                 edi, [eax + 1]</span><br><span class="line">            &#x2F;&#x2F;   8da42400000000       | lea                 esp, [esp]</span><br><span class="line"></span><br><span class="line">        $sequence_5 &#x3D; &#123; 72e3 8bc6 8d5001 5f 8a08 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 5, score &#x3D; 700</span><br><span class="line">            &#x2F;&#x2F;   72e3                 | jb                  0xffffffe5</span><br><span class="line">            &#x2F;&#x2F;   8bc6                 | mov                 eax, esi</span><br><span class="line">            &#x2F;&#x2F;   8d5001               | lea                 edx, [eax + 1]</span><br><span class="line">            &#x2F;&#x2F;   5f                   | pop                 edi</span><br><span class="line">            &#x2F;&#x2F;   8a08                 | mov                 cl, byte ptr [eax]</span><br><span class="line"></span><br><span class="line">        $sequence_6 &#x3D; &#123; 5f 8a08 40 84c9 75f9 2bc2 880c30 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 7, score &#x3D; 700</span><br><span class="line">            &#x2F;&#x2F;   5f                   | pop                 edi</span><br><span class="line">            &#x2F;&#x2F;   8a08                 | mov                 cl, byte ptr [eax]</span><br><span class="line">            &#x2F;&#x2F;   40                   | inc                 eax</span><br><span class="line">            &#x2F;&#x2F;   84c9                 | test                cl, cl</span><br><span class="line">            &#x2F;&#x2F;   75f9                 | jne                 0xfffffffb</span><br><span class="line">            &#x2F;&#x2F;   2bc2                 | sub                 eax, edx</span><br><span class="line">            &#x2F;&#x2F;   880c30               | mov                 byte ptr [eax + esi], cl</span><br><span class="line"></span><br><span class="line">        $sequence_7 &#x3D; &#123; 2bc2 03fb 8a4f01 47 84c9 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 5, score &#x3D; 600</span><br><span class="line">            &#x2F;&#x2F;   2bc2                 | sub                 eax, edx</span><br><span class="line">            &#x2F;&#x2F;   03fb                 | add                 edi, ebx</span><br><span class="line">            &#x2F;&#x2F;   8a4f01               | mov                 cl, byte ptr [edi + 1]</span><br><span class="line">            &#x2F;&#x2F;   47                   | inc                 edi</span><br><span class="line">            &#x2F;&#x2F;   84c9                 | test                cl, cl</span><br><span class="line"></span><br><span class="line">        $sequence_8 &#x3D; &#123; 8bf8 85ff 0f8488000000 6a00 57 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 5, score &#x3D; 600</span><br><span class="line">            &#x2F;&#x2F;   8bf8                 | mov                 edi, eax</span><br><span class="line">            &#x2F;&#x2F;   85ff                 | test                edi, edi</span><br><span class="line">            &#x2F;&#x2F;   0f8488000000         | je                  0x8e</span><br><span class="line">            &#x2F;&#x2F;   6a00                 | push                0</span><br><span class="line">            &#x2F;&#x2F;   57                   | push                edi</span><br><span class="line"></span><br><span class="line">        $sequence_9 &#x3D; &#123; 8b2d???????? 90 8b542410 8d4c2410 51 56 52 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 7, score &#x3D; 600</span><br><span class="line">            &#x2F;&#x2F;   8b2d????????         |                     </span><br><span class="line">            &#x2F;&#x2F;   90                   | nop                 </span><br><span class="line">            &#x2F;&#x2F;   8b542410             | mov                 edx, dword ptr [esp + 0x10]</span><br><span class="line">            &#x2F;&#x2F;   8d4c2410             | lea                 ecx, [esp + 0x10]</span><br><span class="line">            &#x2F;&#x2F;   51                   | push                ecx</span><br><span class="line">            &#x2F;&#x2F;   56                   | push                esi</span><br><span class="line">            &#x2F;&#x2F;   52                   | push                edx</span><br><span class="line"></span><br><span class="line">        $sequence_10 &#x3D; &#123; 6a00 8d442414 50 ffd7 85c0 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 5, score &#x3D; 600</span><br><span class="line">            &#x2F;&#x2F;   6a00                 | push                0</span><br><span class="line">            &#x2F;&#x2F;   8d442414             | lea                 eax, [esp + 0x14]</span><br><span class="line">            &#x2F;&#x2F;   50                   | push                eax</span><br><span class="line">            &#x2F;&#x2F;   ffd7                 | call                edi</span><br><span class="line">            &#x2F;&#x2F;   85c0                 | test                eax, eax</span><br><span class="line"></span><br><span class="line">        $sequence_11 &#x3D; &#123; 8a08 880a 40 42 84c9 75f6 e8???????? &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 7, score &#x3D; 600</span><br><span class="line">            &#x2F;&#x2F;   8a08                 | mov                 cl, byte ptr [eax]</span><br><span class="line">            &#x2F;&#x2F;   880a                 | mov                 byte ptr [edx], cl</span><br><span class="line">            &#x2F;&#x2F;   40                   | inc                 eax</span><br><span class="line">            &#x2F;&#x2F;   42                   | inc                 edx</span><br><span class="line">            &#x2F;&#x2F;   84c9                 | test                cl, cl</span><br><span class="line">            &#x2F;&#x2F;   75f6                 | jne                 0xfffffff8</span><br><span class="line">            &#x2F;&#x2F;   e8????????           |                     </span><br><span class="line"></span><br><span class="line">        $sequence_12 &#x3D; &#123; 8b1d???????? 55 8b2d???????? 90 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 4, score &#x3D; 600</span><br><span class="line">            &#x2F;&#x2F;   8b1d????????         |                     </span><br><span class="line">            &#x2F;&#x2F;   55                   | push                ebp</span><br><span class="line">            &#x2F;&#x2F;   8b2d????????         |                     </span><br><span class="line">            &#x2F;&#x2F;   90                   | nop                 </span><br><span class="line"></span><br><span class="line">        $sequence_13 &#x3D; &#123; ffd7 85c0 7445 53 8b1d???????? &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 5, score &#x3D; 600</span><br><span class="line">            &#x2F;&#x2F;   ffd7                 | call                edi</span><br><span class="line">            &#x2F;&#x2F;   85c0                 | test                eax, eax</span><br><span class="line">            &#x2F;&#x2F;   7445                 | je                  0x47</span><br><span class="line">            &#x2F;&#x2F;   53                   | push                ebx</span><br><span class="line">            &#x2F;&#x2F;   8b1d????????         |                     </span><br><span class="line"></span><br><span class="line">        $sequence_14 &#x3D; &#123; 57 ff15???????? 6a6d 56 ff15???????? 8bf0 e8???????? &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 7, score &#x3D; 600</span><br><span class="line">            &#x2F;&#x2F;   57                   | push                edi</span><br><span class="line">            &#x2F;&#x2F;   ff15????????         |                     </span><br><span class="line">            &#x2F;&#x2F;   6a6d                 | push                0x6d</span><br><span class="line">            &#x2F;&#x2F;   56                   | push                esi</span><br><span class="line">            &#x2F;&#x2F;   ff15????????         |                     </span><br><span class="line">            &#x2F;&#x2F;   8bf0                 | mov                 esi, eax</span><br><span class="line">            &#x2F;&#x2F;   e8????????           |                     </span><br><span class="line"></span><br><span class="line">        $sequence_15 &#x3D; &#123; 6a0a f3a4 6a32 8d8c24ec000000 51 52 e8???????? &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 7, score &#x3D; 500</span><br><span class="line">            &#x2F;&#x2F;   6a0a                 | push                0xa</span><br><span class="line">            &#x2F;&#x2F;   f3a4                 | rep movsb           byte ptr es:[edi], byte ptr [esi]</span><br><span class="line">            &#x2F;&#x2F;   6a32                 | push                0x32</span><br><span class="line">            &#x2F;&#x2F;   8d8c24ec000000       | lea                 ecx, [esp + 0xec]</span><br><span class="line">            &#x2F;&#x2F;   51                   | push                ecx</span><br><span class="line">            &#x2F;&#x2F;   52                   | push                edx</span><br><span class="line">            &#x2F;&#x2F;   e8????????           |                     </span><br><span class="line"></span><br><span class="line">        $sequence_16 &#x3D; &#123; 33f6 51 8945e8 8975e4 e8???????? 8975fc &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 6, score &#x3D; 500</span><br><span class="line">            &#x2F;&#x2F;   33f6                 | xor                 esi, esi</span><br><span class="line">            &#x2F;&#x2F;   51                   | push                ecx</span><br><span class="line">            &#x2F;&#x2F;   8945e8               | mov                 dword ptr [ebp - 0x18], eax</span><br><span class="line">            &#x2F;&#x2F;   8975e4               | mov                 dword ptr [ebp - 0x1c], esi</span><br><span class="line">            &#x2F;&#x2F;   e8????????           |                     </span><br><span class="line">            &#x2F;&#x2F;   8975fc               | mov                 dword ptr [ebp - 4], esi</span><br><span class="line"></span><br><span class="line">        $sequence_17 &#x3D; &#123; 7419 3c26 7515 807c24146c 750e &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 5, score &#x3D; 400</span><br><span class="line">            &#x2F;&#x2F;   7419                 | je                  0x1b</span><br><span class="line">            &#x2F;&#x2F;   3c26                 | cmp                 al, 0x26</span><br><span class="line">            &#x2F;&#x2F;   7515                 | jne                 0x17</span><br><span class="line">            &#x2F;&#x2F;   807c24146c           | cmp                 byte ptr [esp + 0x14], 0x6c</span><br><span class="line">            &#x2F;&#x2F;   750e                 | jne                 0x10</span><br><span class="line"></span><br><span class="line">        $sequence_18 &#x3D; &#123; 8b0c8de03b4100 c1e006 8d440104 8020fe ff36 e8???????? &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 6, score &#x3D; 400</span><br><span class="line">            &#x2F;&#x2F;   8b0c8de03b4100       | mov                 ecx, dword ptr [ecx*4 + 0x413be0]</span><br><span class="line">            &#x2F;&#x2F;   c1e006               | shl                 eax, 6</span><br><span class="line">            &#x2F;&#x2F;   8d440104             | lea                 eax, [ecx + eax + 4]</span><br><span class="line">            &#x2F;&#x2F;   8020fe               | and                 byte ptr [eax], 0xfe</span><br><span class="line">            &#x2F;&#x2F;   ff36                 | push                dword ptr [esi]</span><br><span class="line">            &#x2F;&#x2F;   e8????????           |                     </span><br><span class="line"></span><br><span class="line">        $sequence_19 &#x3D; &#123; 885c2413 bf03000000 eb14 885c2414 bf02000000 eb09 885c2416 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 7, score &#x3D; 400</span><br><span class="line">            &#x2F;&#x2F;   885c2413             | mov                 byte ptr [esp + 0x13], bl</span><br><span class="line">            &#x2F;&#x2F;   bf03000000           | mov                 edi, 3</span><br><span class="line">            &#x2F;&#x2F;   eb14                 | jmp                 0x16</span><br><span class="line">            &#x2F;&#x2F;   885c2414             | mov                 byte ptr [esp + 0x14], bl</span><br><span class="line">            &#x2F;&#x2F;   bf02000000           | mov                 edi, 2</span><br><span class="line">            &#x2F;&#x2F;   eb09                 | jmp                 0xb</span><br><span class="line">            &#x2F;&#x2F;   885c2416             | mov                 byte ptr [esp + 0x16], bl</span><br><span class="line"></span><br><span class="line">        $sequence_20 &#x3D; &#123; ffd6 85c0 75cc 5d 5b &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 5, score &#x3D; 400</span><br><span class="line">            &#x2F;&#x2F;   ffd6                 | call                esi</span><br><span class="line">            &#x2F;&#x2F;   85c0                 | test                eax, eax</span><br><span class="line">            &#x2F;&#x2F;   75cc                 | jne                 0xffffffce</span><br><span class="line">            &#x2F;&#x2F;   5d                   | pop                 ebp</span><br><span class="line">            &#x2F;&#x2F;   5b                   | pop                 ebx</span><br><span class="line"></span><br><span class="line">        $sequence_21 &#x3D; &#123; 59 8b7508 8d34f520104100 391e 7404 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 5, score &#x3D; 400</span><br><span class="line">            &#x2F;&#x2F;   59                   | pop                 ecx</span><br><span class="line">            &#x2F;&#x2F;   8b7508               | mov                 esi, dword ptr [ebp + 8]</span><br><span class="line">            &#x2F;&#x2F;   8d34f520104100       | lea                 esi, [esi*8 + 0x411020]</span><br><span class="line">            &#x2F;&#x2F;   391e                 | cmp                 dword ptr [esi], ebx</span><br><span class="line">            &#x2F;&#x2F;   7404                 | je                  6</span><br><span class="line"></span><br><span class="line">        $sequence_22 &#x3D; &#123; 2bc2 8b542428 50 68???????? 6a01 6a00 &#125;</span><br><span class="line">            &#x2F;&#x2F; n &#x3D; 6, score &#x3D; 200</span><br><span class="line">            &#x2F;&#x2F;   2bc2                 | sub                 eax, edx</span><br><span class="line">            &#x2F;&#x2F;   8b542428             | mov                 edx, dword ptr [esp + 0x28]</span><br><span class="line">            &#x2F;&#x2F;   50                   | push                eax</span><br><span class="line">            &#x2F;&#x2F;   68????????           |                     </span><br><span class="line">            &#x2F;&#x2F;   6a01                 | push                1</span><br><span class="line">            &#x2F;&#x2F;   6a00                 | push                0</span><br><span class="line"></span><br><span class="line">    condition:</span><br><span class="line">        7 of them and filesize &lt; 811008</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="PatchWork"><a href="#PatchWork" class="headerlink" title="PatchWork"></a>PatchWork</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">rule Patchwork_Badnews_v1.0 &#123;</span><br><span class="line">	meta:</span><br><span class="line">		description &#x3D; &quot;Patchwork_Badnews v1.0&quot;</span><br><span class="line">		sample_hash &#x3D; &quot;673d79ea65fca235a3f4adf17ea7ee9d&quot;</span><br><span class="line">		date &#x3D; &quot;2021-01-25&quot;</span><br><span class="line">	strings:</span><br><span class="line">		$mz &#x3D; &#123;4d 5a&#125;</span><br><span class="line">		$string1 &#x3D;&#123;81 FF 80 38 01 00&#125;		&#x2F;&#x2F;cmp edi 0x13880</span><br><span class="line">		$encrypt1 &#x3D; &#123;C1 E9 ?? 83 E1 ??&#125;</span><br><span class="line">		$encrypt2 &#x3D; &#123;83C7??83E9??83C6??&#125;</span><br><span class="line">		$crc &#x3D; &#123;26 63 72 63 3D 65 33 61 36 00&#125;  &#x2F;&#x2F;crc&#x3D;e3a6</span><br><span class="line">	condition:</span><br><span class="line">		($mz at 0) and all of them</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="Donot"><a href="#Donot" class="headerlink" title="Donot"></a>Donot</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">import &quot;pe&quot;</span><br><span class="line">rule donot_Downloader&#123;</span><br><span class="line">	meta:</span><br><span class="line">		description &#x3D; &quot;Donot Downloader&quot;</span><br><span class="line">		sample_hash &#x3D; &quot;1d4ac332517cea3030045b65c325c5330ff7f569c1f7c519498062c0f39972c8&quot;</span><br><span class="line">		date &#x3D; &quot;2021年1月25日&quot;</span><br><span class="line"></span><br><span class="line">	strings:</span><br><span class="line">		$mz &#x3D; &#123;4d 5a&#125;</span><br><span class="line">		$checkVirtual &#x3D; &#123;0f 3f 07 0b&#125;	&#x2F;&#x2F;虚拟机检查</span><br><span class="line">		$string1 &#x3D; &#123;4F0062006E0066003B002100&#125;</span><br><span class="line">		$decrypt1 &#x3D; &#123;8B559C668B4455C06683E8018B4D9C6689444DC0&#125; &#x2F;&#x2F;解密</span><br><span class="line">		&#x2F;&#x2F;$string2 &#x3D; &#123;7C 00 7C 00 7C 00 7C 00 7C 00 7C 00 ?? ?? ?? ?? 7C 00 7C 00 7C 00 ?? ?? 7C 00 7C 00 7C&#125; &#x2F;&#x2F;版本？</span><br><span class="line">	condition:</span><br><span class="line">		($mz at 0) and all of them</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rule donot_yoyojitox_signature&#123;</span><br><span class="line">	meta:</span><br><span class="line">    	description &#x3D; &quot;Donot yoyojitox Signature&quot;</span><br><span class="line">        simple_hash &#x3D; &quot;a057af76ead1d6c1abab5b73c6cabf56cd0e42fe24c2e2d3b7c7cae45102bd67&quot;</span><br><span class="line">        date &#x3D; &quot;2021年2月4日&quot;</span><br><span class="line">	strings:</span><br><span class="line">    	$mz &#x3D; &#123;4d 5a&#125;</span><br><span class="line">    condition:</span><br><span class="line">    	($mz at 0) and </span><br><span class="line">         for any i in (0 .. pe.number_of_signatures) : (</span><br><span class="line">			pe.signatures[i].serial &#x3D;&#x3D; &quot;06:fc:34:d3:43:cf:6a:8c:41:e3:aa:c2:85:d6:e4:87&quot;</span><br><span class="line">      )</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">rule donot_yogonita_signature&#123;</span><br><span class="line">	meta:</span><br><span class="line">    	description &#x3D; &quot;Donot yogonita Signature&quot;</span><br><span class="line">        simple_hash &#x3D; &quot;0acf801b4b679e409ebe2917a75a5048a20ca9861df3d496b914b3e5f1af560a&quot;</span><br><span class="line">        date &#x3D; &quot;2021年2月23日&quot;</span><br><span class="line">	strings:</span><br><span class="line">    	$mz &#x3D; &#123;4d 5a&#125;</span><br><span class="line">    condition:</span><br><span class="line">    	($mz at 0) and </span><br><span class="line">         for any i in (0 .. pe.number_of_signatures) : (</span><br><span class="line">			pe.signatures[i].serial &#x3D;&#x3D; &quot;44:75:b0:a1:22:61:7b:be:46:e5:d7:f1:7a:a6:c6:df&quot;</span><br><span class="line">      )</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rule donot_doc_downloader&#123;</span><br><span class="line">	meta:</span><br><span class="line">		description &#x3D; &quot;Donot doc downloader&quot;</span><br><span class="line">		sample_hash &#x3D; &quot;d4d86fc91e4fec9b1d9de30aa22a70cdc3509726bffeee61d526fdfc243081b5&quot;</span><br><span class="line">		date &#x3D; &quot;2021-02-23&quot;</span><br><span class="line">		remark &#x3D; &quot;test&quot;</span><br><span class="line">	strings:</span><br><span class="line">		$func1 &#x3D; &quot;CreateRemoteThread&quot;ascii wide</span><br><span class="line">		$func2 &#x3D; &quot;VirtualAlloc&quot;ascii wide</span><br><span class="line">		$func3 &#x3D; &quot;RtlMoveMemory&quot;ascii wide</span><br><span class="line">		$string1 &#x3D; &quot;AutooPEN&quot;</span><br><span class="line">		$string2 &#x3D; &quot;WOrkBook_OPen&quot;nocase ascii wide</span><br><span class="line">	condition:</span><br><span class="line">		all of them</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Yenn_</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://0xdf1001f.github.io/2020/12/01/Yara%E8%A7%84%E5%88%99/">https://0xdf1001f.github.io/2020/12/01/Yara%E8%A7%84%E5%88%99/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://0xdf1001f.github.io">Wei's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%B7%A5%E5%85%B7/">工具    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master/20201201113139.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/12/03/Png-Dropper/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master/20201207115414.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>Png Dropper</span></div></a></div><div class="next-post pull_right"><a href="/2020/11/24/%E5%9C%A8X64DBG%E4%B8%AD%E8%B0%83%E8%AF%95DLL%E7%9A%84%E5%AF%BC%E5%87%BA%E5%87%BD%E6%95%B0/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master/20201127104927.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>在X64DBG中调试DLL的导出函数</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/12/07/IDA中识别库函数/" title="IDA中识别库函数"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master/20201207173004.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-12-07</div><div class="relatedPosts_title">IDA中识别库函数</div></div></a></div><div class="relatedPosts_item"><a href="/2021/01/18/Python将短链还原/" title="Python将短链还原"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master//20210118191929.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2021-01-18</div><div class="relatedPosts_title">Python将短链还原</div></div></a></div><div class="relatedPosts_item"><a href="/2020/11/17/一些可能有用可能毫无卵用的在线工具/" title="一些可能有用可能毫无卵用的在线工具"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master/20201201140412.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-11-17</div><div class="relatedPosts_title">一些可能有用可能毫无卵用的在线工具</div></div></a></div><div class="relatedPosts_item"><a href="/2020/12/22/对Excel-4-0-Macro恶意代码的一次分析/" title="对Excel 4.0 Macro恶意代码的一次分析"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master//20201222164253.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-12-22</div><div class="relatedPosts_title">对Excel 4.0 Macro恶意代码的一次分析</div></div></a></div><div class="relatedPosts_item"><a href="/2020/11/24/在X64DBG中调试DLL的导出函数/" title="在X64DBG中调试DLL的导出函数"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master/20201127104927.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-11-24</div><div class="relatedPosts_title">在X64DBG中调试DLL的导出函数</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = false == true ? true : false;
var verify = false == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'4iHpByXHTO1Rz8Jp7z1nJ211-gzGzoHsz',
  appKey:'dR4gLrc51geG7WX58ESN7dmJ',
  placeholder:'留个言再走⑧',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10',
  lang:'zh-cn',
  recordIP: true
});</script></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By Yenn_</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">阿炜's Blog</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">简</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/ClickShowText.js"></script></body></html>