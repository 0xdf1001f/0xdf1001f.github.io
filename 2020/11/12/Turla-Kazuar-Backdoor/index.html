<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>Turla - Kazuar Backdoor | Wei's Blog</title><meta name="description" content="Turla的样本分析，传说中劫持卫星的带佬。"><meta name="keywords" content="恶意软件"><meta name="author" content="Yenn_"><meta name="copyright" content="Yenn_"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Turla - Kazuar Backdoor"><meta name="twitter:description" content="Turla的样本分析，传说中劫持卫星的带佬。"><meta name="twitter:image" content="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201112113025.png"><meta property="og:type" content="article"><meta property="og:title" content="Turla - Kazuar Backdoor"><meta property="og:url" content="https://0xdf1001f.github.io/2020/11/12/Turla-Kazuar-Backdoor/"><meta property="og:site_name" content="Wei's Blog"><meta property="og:description" content="Turla的样本分析，传说中劫持卫星的带佬。"><meta property="og:image" content="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201112113025.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = '2'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://0xdf1001f.github.io/2020/11/12/Turla-Kazuar-Backdoor/"><link rel="next" title="HW中的一枚CS马" href="https://0xdf1001f.github.io/2020/09/19/HW%E4%B8%AD%E7%9A%84%E4%B8%80%E6%9E%9ACS%E9%A9%AC/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: {"text":"富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善","fontSize":"15px"},
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Wei's Blog</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">17</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">6</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">3</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#Turla"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">Turla</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#Kazuar-backdoor-e888b93f4d5f28699b29271a95ccad55ca937977d442228637ad9a7c037d3a6a4"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">Kazuar backdoor - e888b93f4d5f28699b29271a95ccad55ca937977d442228637ad9a7c037d3a6a4</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#基本信息"><span class="toc_mobile_items-number">1.1.1.</span> <span class="toc_mobile_items-text">基本信息</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#样本分析"><span class="toc_mobile_items-number">1.1.2.</span> <span class="toc_mobile_items-text">样本分析</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#初始化"><span class="toc_mobile_items-number">1.1.2.1.</span> <span class="toc_mobile_items-text">初始化</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#Rijndael加密"><span class="toc_mobile_items-number">1.1.2.2.</span> <span class="toc_mobile_items-text">Rijndael加密</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#判断样本运行状态"><span class="toc_mobile_items-number">1.1.2.3.</span> <span class="toc_mobile_items-text">判断样本运行状态</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#注入到explorer"><span class="toc_mobile_items-number">1.1.2.4.</span> <span class="toc_mobile_items-text">注入到explorer</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#CLR-Runtime-Loader"><span class="toc_mobile_items-number">1.1.2.5.</span> <span class="toc_mobile_items-text">CLR Runtime Loader</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#自启创建"><span class="toc_mobile_items-number">1.1.2.6.</span> <span class="toc_mobile_items-text">自启创建</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#远程连接"><span class="toc_mobile_items-number">1.1.2.7.</span> <span class="toc_mobile_items-text">远程连接</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#命令执行"><span class="toc_mobile_items-number">1.1.2.8.</span> <span class="toc_mobile_items-text">命令执行</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#IOC"><span class="toc_mobile_items-number">1.1.3.</span> <span class="toc_mobile_items-text">IOC</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Turla"><span class="toc-number">1.</span> <span class="toc-text">Turla</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Kazuar-backdoor-e888b93f4d5f28699b29271a95ccad55ca937977d442228637ad9a7c037d3a6a4"><span class="toc-number">1.1.</span> <span class="toc-text">Kazuar backdoor - e888b93f4d5f28699b29271a95ccad55ca937977d442228637ad9a7c037d3a6a4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基本信息"><span class="toc-number">1.1.1.</span> <span class="toc-text">基本信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#样本分析"><span class="toc-number">1.1.2.</span> <span class="toc-text">样本分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#初始化"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">初始化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Rijndael加密"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">Rijndael加密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#判断样本运行状态"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">判断样本运行状态</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#注入到explorer"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">注入到explorer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CLR-Runtime-Loader"><span class="toc-number">1.1.2.5.</span> <span class="toc-text">CLR Runtime Loader</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#自启创建"><span class="toc-number">1.1.2.6.</span> <span class="toc-text">自启创建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#远程连接"><span class="toc-number">1.1.2.7.</span> <span class="toc-text">远程连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#命令执行"><span class="toc-number">1.1.2.8.</span> <span class="toc-text">命令执行</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IOC"><span class="toc-number">1.1.3.</span> <span class="toc-text">IOC</span></a></li></ol></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201112113025.png)"><div id="post-info"><div id="post-title"><div class="posttitle">Turla - Kazuar Backdoor</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-11-12<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-11-12</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Windows/">Windows</a><i class="fa fa-angle-right fa-fw" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Windows/%E6%A0%B7%E6%9C%AC/">样本</a></span><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">1.9k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>阅读时长: 8 分钟</span><div class="post-meta-pv-cv"><span class="post-meta__separator">|</span><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="Turla"><a href="#Turla" class="headerlink" title="Turla"></a>Turla</h1><p>Turla，也被称为Venomous Bear、Waterbug和Uroboros，是迄今为止最为高级的威胁组织之一，并被认为隶属于俄罗斯政府（该组织成员均说俄语）。虽然该组织被认为至少在2007年就已经成立，但直到2014年它才被卡巴斯基实验室发现。</p>
<h2 id="Kazuar-backdoor-e888b93f4d5f28699b29271a95ccad55ca937977d442228637ad9a7c037d3a6a4"><a href="#Kazuar-backdoor-e888b93f4d5f28699b29271a95ccad55ca937977d442228637ad9a7c037d3a6a4" class="headerlink" title="Kazuar backdoor - e888b93f4d5f28699b29271a95ccad55ca937977d442228637ad9a7c037d3a6a4"></a>Kazuar backdoor - e888b93f4d5f28699b29271a95ccad55ca937977d442228637ad9a7c037d3a6a4</h2><h3 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h3><table>
<thead>
<tr>
<th>File Name</th>
<th>File Size</th>
<th>File Type</th>
<th>MD5</th>
</tr>
</thead>
<tbody><tr>
<td>DebugView.exe</td>
<td>137,728 Byte</td>
<td>BackDoor</td>
<td>277f2d8e682f7ffc071560f44af4ab41</td>
</tr>
</tbody></table>
<h3 id="样本分析"><a href="#样本分析" class="headerlink" title="样本分析"></a>样本分析</h3><h4 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h4><p>样本似乎伪造为Windows下的SysInternal套件</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201112105634.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201112105634.png" class="lazyload"></a></p>
<p>样本内的类和函数命名都是由两位字符组成</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109110348.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109110348.png" class="lazyload"></a></p>
<p>设置样本中的异常处理，将异常发送到ThreadException</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109111821.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109111821.png" class="lazyload"></a></p>
<p>通过字符串“”gGYJ\YwJ1sggs1YBg31GjGg14\dd0d}w}ds4””解密出一串GUID</p>
<p>“169739e7-2112-9514-6a61-d300c0fef02d”</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109112127.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109112127.png" class="lazyload"></a></p>
<p>根据Gethostid返回的值与13取余，根据余数来决定在哪个文件夹释放创建新文件夹释放文件，在这里取到的路径为“C:\Users\sam\AppData\Local\Microsoft\Network\3DDC94D8”，得到路径后创建文件夹</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109113317.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109113317.png" class="lazyload"></a></p>
<p>获取计算机信息、解密加载出后续操作使用的内容，并通过前面解密出的”169739e7-2112-9514-6a61-d300c0fef02d”创建一个新GUID</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109114122.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109114122.png" class="lazyload"></a></p>
<p>创建互斥量，互斥量都是由Username+固定字符串解密内容，根据UserName不同，生成的互斥量也不同，格式为Global\\+生成的与GUID同一格式的内容</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109114558.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109114558.png" class="lazyload"></a></p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109114930.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109114930.png" class="lazyload"></a></p>
<h4 id="Rijndael加密"><a href="#Rijndael加密" class="headerlink" title="Rijndael加密"></a>Rijndael加密</h4><p>在文件夹“C:\Users\sam\AppData\Local\Microsoft\Network\3DDC94D8\3F515151”创建文件，写入程序运行的日志，写入的日志由Rijndael加密，KEY值由当前时间计算得出，通过KEY与文件的内容可以解密出样本的日志文件</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109144917.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109144917.png" class="lazyload"></a></p>
<p>加密：</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109150027.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109150027.png" class="lazyload"></a></p>
<h4 id="判断样本运行状态"><a href="#判断样本运行状态" class="headerlink" title="判断样本运行状态"></a>判断样本运行状态</h4><p>判断样本运行状态，进行不同的操作，主入口点有4种不同的路径：</p>
<ol>
<li>如果恶意软件是使用“ install”命令行参数执行的，则该参数使用.NET Framwork的InstallHelper方法将恶意软件作为服务安装。</li>
<li>如果恶意软件是在非用户交互环境（没有用户界面）中启动的，则该恶意软件会自己安装为服务。</li>
<li>如果未提供任何参数，并且恶意软件确定其在Windows环境中运行，则会将DLL注入到窗口“Shell_TrayWnd”中，执行DLL中的内容</li>
<li>如果恶意软件是使用“单个”命令行参数执行的，或者恶意软件确定其在Mac或Unix环境中运行，则它将运行包含Kazuar功能代码的方法。</li>
</ol>
<h4 id="注入到explorer"><a href="#注入到explorer" class="headerlink" title="注入到explorer"></a>注入到explorer</h4><p>调试过程中进入了流程3，样本先提权到SeDebugPrivilege权限</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109152012.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109152012.png" class="lazyload"></a></p>
<p>为Shell_TrayWnd窗口设置WindowsHook，注入DLL到explorer.exe中</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109153133.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109153133.png" class="lazyload"></a></p>
<p>注入后的explorer.exe</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109171124.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109171124.png" class="lazyload"></a></p>
<h4 id="CLR-Runtime-Loader"><a href="#CLR-Runtime-Loader" class="headerlink" title="CLR Runtime Loader"></a>CLR Runtime Loader</h4><p>在explorer.exe中注入的DLL实际是一个CLR RUNTIME LOADER，负责加载执行先前样本中的内容</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109195620.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201109195620.png" class="lazyload"></a></p>
<p>类似样本中CLR Runtime Loader的源码，加载CLR Runtime到Target中执行</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">__declspec(dllexport) HRESULT LoadDNA(_In_ LPCTSTR lpCommand) &#123;</span><br><span class="line">  HRESULT hr;</span><br><span class="line">  ICLRMetaHost * pMetaHost &#x3D; NULL;</span><br><span class="line">  ICLRRuntimeInfo * pRuntimeInfo &#x3D; NULL;</span><br><span class="line">  ICLRRuntimeHost * pClrRuntimeHost &#x3D; NULL;</span><br><span class="line">  &#x2F;&#x2F; Load .NET Runtime</span><br><span class="line">  hr &#x3D; CLRCreateInstance(CLSID_CLRMetaHost, IID_PPV_ARGS( &amp; pMetaHost));</span><br><span class="line">  hr &#x3D; pMetaHost - &gt;GetRuntime(L &quot;v4.0.30319&quot;, IID_PPV_ARGS( &amp; pRuntimeInfo));</span><br><span class="line">  hr &#x3D; pRuntimeInfo - &gt;GetInterface(CLSID_CLRRuntimeHost, IID_PPV_ARGS( &amp; pClrRuntimeHost));</span><br><span class="line">  &#x2F;&#x2F; Start Runtime</span><br><span class="line">  hr &#x3D; pClrRuntimeHost - &gt;Start();</span><br><span class="line">  &#x2F;&#x2F; Parse Arguments</span><br><span class="line">  ClrLoaderArgs args(lpCommand);</span><br><span class="line">  &#x2F;&#x2F; Execute Loaded .NET Code</span><br><span class="line">  DWORD pReturnValue;</span><br><span class="line">  hr &#x3D; pClrRuntimeHost - &gt;ExecuteInDefaultAppDomain(</span><br><span class="line">  	  args.pwzAssemblyPath.c_str(), </span><br><span class="line">      args.pwzTypeName.c_str(), </span><br><span class="line">      args.pwzMethodName.c_str(), </span><br><span class="line">      args.pwzArgument.c_str(), </span><br><span class="line">      &amp;pReturnValue);</span><br><span class="line">  &#x2F;&#x2F; Release and Free Resources</span><br><span class="line">  pMetaHost - &gt;Release();</span><br><span class="line">  pRuntimeInfo - &gt;Release();</span><br><span class="line">  pClrRuntimeHost - &gt;Release();</span><br><span class="line">  &#x2F;&#x2F; Return .NET Code Result</span><br><span class="line">  return hr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>加载完成后执行流程又回到了DbgView.exe中,调用了dbgview中的W.s()方法</p>
<p>设置异常处理</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110141656.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110141656.png" class="lazyload"></a></p>
<h4 id="自启创建"><a href="#自启创建" class="headerlink" title="自启创建"></a>自启创建</h4><p>查询当前的进程名是否为被注入的进程，可以看出程序会注入的程序包含“iexplore”,”firefox”,”browser”,”outlook”,”chrome”,”nlnotes”,”notes2”,”opera”,”msimn”</p>
<p>根据查询的结果会创建不同的线程</p>
<p>当注入的不是上述进程时：</p>
<p>与样本最开始相同会查询系统信息，然后尝试持久化操作，但在调试过程中创建自启动没有成功，返回字符串“DISABLE”，尝试的注册表路径</p>
<ul>
<li>SOFTWARE\Microsoft\Windows\CurrentVersion\Run</li>
<li>SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce</li>
<li>SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</li>
<li>SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</li>
<li>SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\load</li>
</ul>
<p>或尝试添加自启动.lnk到启动目录</p>
<h4 id="远程连接"><a href="#远程连接" class="headerlink" title="远程连接"></a>远程连接</h4><p>创建了一个IPC远程通道</p>
<p>“ipc://5728912222233c6860fe9a5a2ae45a7e/d22f298e18a16a3175ea1a78b5419c91”</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110145350.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110145350.png" class="lazyload"></a></p>
<p>从样本向日志中写入的内容来看，样本将C2下发的命令操作称为”Task”</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110152200.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110152200.png" class="lazyload"></a></p>
<p>功能还带有注入到其他进程中的功能</p>
<p>当当前进程为“iexplore”,”firefox”,”browser”,”outlook”,”chrome”,”nlnotes”,”notes2”,”opera”,”msimn”时</p>
<p>尝试与C2链接，C2的地址由</p>
<p>“C:\Users\sam\AppData\Local\Microsoft\Network&quot;下文件取出，当文件不存在时，样本还存在default server</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110162036.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110162036.png" class="lazyload"></a></p>
<p>解密出的两个Default Server:</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110163606.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110163606.png" class="lazyload"></a></p>
<p>“<a href="https://www.bombheros.com/wp-content/languages/index.php&quot;" target="_blank" rel="noopener">https://www.bombheros.com/wp-content/languages/index.php&quot;</a><br>        “<a href="https://www.simplifiedhomesales.com/wp-includes/images/index.php&quot;" target="_blank" rel="noopener">https://www.simplifiedhomesales.com/wp-includes/images/index.php&quot;</a></p>
<p>与C2通信支持的协议类型包含”http”.”https”,”ftp”,”ftps”</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110164140.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110164140.png" class="lazyload"></a></p>
<p>查询窗口，检测抓包软件，包括</p>
<p>“megadumper”,”smartsniff”,”snoopypro”,”wireshark”,”ethereal”,”tcpview”,”tcpdump”,”windump”,”portmon”,”dsniff”,</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110165053.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110165053.png" class="lazyload"></a></p>
<p>向C2发送HTTP请求,cookie字段为GUID的base64编码，用于标识被感染主机</p>
<p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110170844.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201110170844.png" class="lazyload"></a></p>
<h4 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h4><p><a href="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201112111915.png" target="_blank" rel="noopener" data-fancybox="group" data-caption class="fancybox"><img alt title data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201112111915.png" class="lazyload"></a></p>
<table>
<thead>
<tr>
<th><strong>Action ID</strong></th>
<th><strong>Commands</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>1</strong></td>
<td>log</td>
<td>Logs a specified debug message</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>get</td>
<td>Upload files from a specified directory. It appears the actor can specify which files to upload based on their modified, accessed and created timestamps as well.</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>put</td>
<td>Writes provided data (referred to as ‘payload’) to a specified file on the system.</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>cmd</td>
<td>Executes a specified command and writes the output to a temporary file. The temporary file is uploaded to the C2 server</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>sleep</td>
<td>Trojan sleeps for a specified time</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>upgrade</td>
<td>Upgrades the Trojan by changing the current executable’s file extension to “.old” and writing a newly provided executable in its place</td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>scrshot</td>
<td>Takes a screenshot of the entire visible screen. The screenshot is saved to a specified filename or using a filename with the following format: [year]-[month]-[day]-[hour]-[minute]-[second]-[milisecond].jpg. The file is uploaded to the C2 server</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>camshot</td>
<td>Creates a Window called “WebCapt” to capture an image from an attached webcam, which it copies to the clipboard and writes to a specified file or a file following the same format from the “scrshot” command. The file is uploaded to the C2 server</td>
</tr>
<tr>
<td><strong>9</strong></td>
<td>uuid</td>
<td>Sets the unique agent identifier by providing a specific GUID</td>
</tr>
<tr>
<td><strong>10</strong></td>
<td>interval</td>
<td>Sets the transport intervals, specifically the minimum and maximum time intervals between C2 communications.</td>
</tr>
<tr>
<td><strong>11</strong></td>
<td>server</td>
<td>Sets the C2 servers by providing a list of URLs</td>
</tr>
<tr>
<td><strong>12</strong></td>
<td>transport</td>
<td>Sets the transport processes by providing a list of processes that Kazuar will inject its code and execute within.</td>
</tr>
<tr>
<td><strong>13</strong></td>
<td>autorun</td>
<td>Sets the autorun type as discussed earlier in this blog. Kazuar will accept the following strings for this command: DISABLED, WINLOGON, POLICIES, HKCURUN, RUNONCE, LOADKEY, STARTUP</td>
</tr>
<tr>
<td><strong>14</strong></td>
<td>remote</td>
<td>Sets a remote type. We are only aware of one remote type that instructs Kazuar to act as an HTTP server and allow the threat actor to interact with the compromised system via inbound HTTP requests.</td>
</tr>
<tr>
<td><strong>15</strong></td>
<td>info</td>
<td>Gathers system information, specifically information referred to as: Agent information, System information, User information, Local groups and members, Installed software, Special folders, Environment variables, Network adapters, Active network connections, Logical drives, Running processes and Opened windows</td>
</tr>
<tr>
<td><strong>16</strong></td>
<td>copy</td>
<td>Copies a specified file to a specified location. Also allows the C2 to supply a flag to overwrite the destination file if it already exists.</td>
</tr>
<tr>
<td><strong>17</strong></td>
<td>move</td>
<td>Moves a specified file to a specified location. Also allows the C2 to supply a flag to delete the destination file if it exists.</td>
</tr>
<tr>
<td><strong>18</strong></td>
<td>remove</td>
<td>Deletes a specified file. Allows the C2 to supply a flag to securely delete a file by overwriting the file with random data before deleting the file.</td>
</tr>
<tr>
<td><strong>19</strong></td>
<td>finddir</td>
<td>Find a specified directory and list its files, including the created and modified timestamps, the size and file path for each of the files within the directory.</td>
</tr>
<tr>
<td><strong>20</strong></td>
<td>kill</td>
<td>Kills a process by name or by process identifier (PID)</td>
</tr>
<tr>
<td><strong>21</strong></td>
<td>tasklisk</td>
<td>List running processes. Uses a WMI query of “select * from Win32_Process” for a Windows system, but can also running “ps -eo comm,pid,ppid,user,start,tty,args” to obtain running processes from a Unix system.</td>
</tr>
<tr>
<td><strong>22</strong></td>
<td>suicide</td>
<td>We believe this command is meant to uninstall the Trojan, but it is not currently implemented in the known samples.</td>
</tr>
<tr>
<td><strong>23</strong></td>
<td>plugin</td>
<td>Installing plugin by loading a provided Assembly, saving it to a file whose name is the MD5 hash of the Assembly’s name and calling a method called “Start”.</td>
</tr>
<tr>
<td><strong>24</strong></td>
<td>plugout</td>
<td>Removes a plugin based on the Assembly’s name.</td>
</tr>
<tr>
<td><strong>25</strong></td>
<td>pluglist</td>
<td>Gets a list of plugins and if they are “working” or “stopped”</td>
</tr>
<tr>
<td><strong>26</strong></td>
<td>run</td>
<td>Runs a specified executable with supplied arguments and saves its output to a temporary file. The temporary file is up loaded to the C2 server.</td>
</tr>
</tbody></table>
<h3 id="IOC"><a href="#IOC" class="headerlink" title="IOC"></a>IOC</h3><p> “<a href="https://www.bombheros.com/wp-content/languages/index.php&quot;" target="_blank" rel="noopener">https://www.bombheros.com/wp-content/languages/index.php&quot;</a><br>        “<a href="https://www.simplifiedhomesales.com/wp-includes/images/index.php&quot;" target="_blank" rel="noopener">https://www.simplifiedhomesales.com/wp-includes/images/index.php&quot;</a></p>
<p>参考链接：</p>
<p>1.<a href="https://www.accenture.com/us-en/blogs/cyber-defense/turla-belugasturgeon-compromises-government-entity" target="_blank" rel="noopener">https://www.accenture.com/us-en/blogs/cyber-defense/turla-belugasturgeon-compromises-government-entity</a></p>
<p>2.<a href="https://unit42.paloaltonetworks.com/unit42-kazuar-multiplatform-espionage-backdoor-api-access/" target="_blank" rel="noopener">https://unit42.paloaltonetworks.com/unit42-kazuar-multiplatform-espionage-backdoor-api-access/</a></p>
<p>3.<a href="https://www.epicturla.com/blog/sysinturla" target="_blank" rel="noopener">https://www.epicturla.com/blog/sysinturla</a></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Yenn_</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://0xdf1001f.github.io/2020/11/12/Turla-Kazuar-Backdoor/">https://0xdf1001f.github.io/2020/11/12/Turla-Kazuar-Backdoor/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://0xdf1001f.github.io">Wei's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6/">恶意软件    </a></div><div class="post_share"><div class="social-share" data-image="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201112113025.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="next-post pull-full"><a href="/2020/09/19/HW%E4%B8%AD%E7%9A%84%E4%B8%80%E6%9E%9ACS%E9%A9%AC/"><img class="next_cover lazyload" data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201106193001.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>HW中的一枚CS马</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/09/19/HW中的一枚CS马/" title="HW中的一枚CS马"><img class="relatedPosts_cover lazyload"data-src="https://blog-1251128945.cos.ap-beijing.myqcloud.com/20201106193001.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-09-19</div><div class="relatedPosts_title">HW中的一枚CS马</div></div></a></div><div class="relatedPosts_item"><a href="/2020/06/06/Ramsay/" title="Ramsay"><img class="relatedPosts_cover lazyload"data-src="http://ww1.sinaimg.cn/large/006o5z8lgy1gcutqxg6juj309w03x0st.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-06-06</div><div class="relatedPosts_title">Ramsay</div></div></a></div><div class="relatedPosts_item"><a href="/2020/06/06/e5799d14e6ecfefb727bf22c8b9f36a8621655454a6480f3dd94812250bec9d0/" title="e5799d14e6ecfefb727bf22c8b9f36a8621655454a6480f3dd94812250bec9d0"><img class="relatedPosts_cover lazyload"data-src="http://ww1.sinaimg.cn/large/006o5z8lgy1gcutqxg6juj309w03x0st.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-06-06</div><div class="relatedPosts_title">e5799d14e6ecfefb727bf22c8b9f36a8621655454a6480f3dd94812250bec9d0</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/20/利用系统文件执行的远控/" title="利用系统文件执行的远控"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master/rat.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-20</div><div class="relatedPosts_title">利用系统文件执行的远控</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/24/xls宏病毒，程序不落地创建傀儡进程实现远控/" title="xls宏病毒，程序不落地创建傀儡进程实现远控"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master/rrat.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-24</div><div class="relatedPosts_title">xls宏病毒，程序不落地创建傀儡进程实现远控</div></div></a></div><div class="relatedPosts_item"><a href="/2020/03/19/低能勒索病毒/" title="低能勒索病毒"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/0xdf1001f/cdn@master/E.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-19</div><div class="relatedPosts_title">低能勒索病毒</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = false == true ? true : false;
var verify = false == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'4iHpByXHTO1Rz8Jp7z1nJ211-gzGzoHsz',
  appKey:'dR4gLrc51geG7WX58ESN7dmJ',
  placeholder:'留个言再走⑧',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10',
  lang:'zh-cn',
  recordIP: true
});</script></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By Yenn_</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">阿炜's Blog</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">简</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/ClickShowText.js"></script></body></html>